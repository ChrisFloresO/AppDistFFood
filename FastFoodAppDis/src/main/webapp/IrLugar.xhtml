<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:m="http://code.google.com/p/gmaps4jsf/">

<h:head>
	<title>UBICACANOS</title>
	<meta charset="utf-8" />
	<meta name="format-detection" content="telephone=no" />
	<link rel="icon" href="resources/template/site/images/favicon.ico"
		type="image/x-icon" />
	<link rel="stylesheet" href="resources/template/site/css/grid.css" />
	<link rel="stylesheet" href="resources/template/site/css/style.css" />

	<script src="resources/template/site/js/jquery.js"></script>
	<script src="resources/template/site/js/jquery-migrate-1.2.1.js"></script>
	<script src="resources/template/site/js/device.min.js"></script>

	<style>
		#map {
			height: 450px;
		}
		
		html, body {
			height: 100%;
			margin: 0;
			padding: 0;
		}
		</style>
	</h:head>

<body>
	<header>

	<div id="stuck_container" class="stuck_container">
		<div class="container">

			<div class="brand">
				<h1 class="brand_name">
					<a href="./">Fast Food</a>
				</h1>
			</div>

			<nav class="nav">
			<ul class="sf-menu">
				<li><a href="Home.xhtml">Home</a></li>
				<li class="active"><a href="bl.xhtml">Menu</a></li>
				<li><a href="index-2.html">Ubicanos</a></li>
				<li><a href="index-4.html">Contacts</a></li>
			</ul>
			</nav>
		</div>
	</div>
	</header>
	<!-- {INICIO DEL MAPA} -->
	<div id="mainCarousel">
		<div id="myCarousel" class="carousel slide" data-ride="carousel">

			<div class="item active">

				<!-- Inicio del Mapa -->

				<div id="map"></div>

				<script>
      		function initMap() {
                var map = new google.maps.Map(document.getElementById('map'), {
                    center: {lat: 18.0858100, lng: -15.9785000},
                    zoom: 12
                });

                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function (position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        var pos1 = {
                            lat: -2.887590,
                            lng: -78.993732
                        };


                        var marker = new google.maps.Marker({
                            position: pos,
                            map: map,
                            draggable: true,
                            animation: google.maps.Animation.DROP,
                            label: 'Mi Ubicacion'
                        });
                        map.setCenter(pos);
                        map.setZoom(15);

                       
                        google.maps.event.addListener(map, 'click', function (event) {
                            addMarker(event.latLng, map);
                            document.getElementById('in').value = event.latLng.lat();
                            document.getElementById('form:la').value = event.latLng.lat();
                            document.getElementById('form:lo').value = event.latLng.lng();
                            
                            
                        });

                        function addMarker(location, map) {
                            var marker = new google.maps.Marker({
                                position: location,
                                map: map,
                                draggable: true,
                                animation: google.maps.Animation.DROP
                            });
                        }
                        function calcRoute() {
                      	  var start = document.getElementById('start').value;
                      	  var end = document.getElementById('end').value;
                      	  var request = {
                      	      origin:start,
                      	      destination:end,
                      	      travelMode: google.maps.DirectionsTravelMode.DRIVING
                      	  };
                      	  directionsService.route(request, function(response, status) {
                      	    if (status == google.maps.DirectionsStatus.OK) {
                      	      directionsDisplay.setDirections(response);
                      	    }
                      	  });
                      	}

                        function ruta(location) {
                            var objConfigDR = {
                                map: map,
                            }

                            var objConfigDS = {
                                origin: pos,
                                destination: location,
                                travelMode: google.maps.TravelMode.DRIVING
                            }

                            var directionsService = new google.maps.DirectionsService();
                            var directionRenderer = new google.maps.DirectionsRenderer(objConfigDR);

                            directionsService.route(objConfigDS, fnRutear);


                            function fnRutear(resultados, status) {
                                if (status == 'OK') {
                                    directionRenderer.setDirections(resultados);
                                } else {
                                    alert('error' + status);
                                }
                            }
                        }

                    }, function () {
                        //handleLocationError(true, infoWindow, map.getCenter());
                    });

                }
                else {
                   
                }
            }
      		function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        		infoWindow.setPosition(pos);
        		infoWindow.setContent(browserHasGeolocation ?
                	'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.');
      		}  
      		        	  		
      	</script>

				<script
					src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAy4rf6Y4Q2TCiAPuFkFaVK6qcEGaBd_H0 &amp;callback=initMap">
    	</script>
			</div>

		</div>

		<!-- Fin del Mapa -->
		<!-- /.carousel -->
	</div>
	<!-- {FIN DEL MAPA	} -->
	<h:body>
		<main>
		<center>
			<h:form id="formulario">

				<h:panelGroup id="mapGroup">

					<h:inputHidden id="latitud" value="#{mapaControler.latitud}" />
					<h:inputHidden id="longitud" value="#{mapaControler.longitud}" />
	#{mapaControler.action()}
	<m:map zoom="16" width="100%" height="500px" latitude="-2.8788134"
						longitude="-79.0023418" enableScrollWheelZoom="true"
						renderOnWinLoad="true">
						<m:mapControl name="GLargeMapControl"
							position="G_ANCHOR_BOTTOM_LEFT" />

						<m:marker latitude="#{mapaControler.latitud}"
							longitude="#{mapaControler.longitud}">
							<m:htmlInformationWindow id="window2"
								htmlText="#{mapaControler.descripcion}" />
						</m:marker>

						<ui:repeat var="item" varStatus="status"
							value="#{mapaControler.ub}">
							<m:marker latitude="#{item.latitud}" longitude="#{item.longitud}">
								<m:htmlInformationWindow id="window2"
									htmlText="#{item.descripcion}" />
							</m:marker>
						</ui:repeat>

						<m:direction attachNodeId="steps"
							fromAddress="#{mapaControler.latitud} ,#{mapaControler.longitud}"
							toAddress="#{mapaControler.latituddes},#{mapaControler.longituddes}"
							style="width:100%;heigth:100%" travelMode="G_TRAVEL_MODE_DRIVING" />
					</m:map>


					

				</h:panelGroup>
				<center>
					<h:commandButton value="Ver mi Ubicacion"
						action="#{mapaControler.action()}">
					</h:commandButton>
					<h:commandButton value="Calcular"
						action="#{mapaControler.calcular(mapaControler.descripcion,mapaControler.latitud,mapaControler.longitud)}">

					</h:commandButton>
				</center>

			</h:form>
			<center>
				<h2>
					<em></em>Indicaciones para llegar
				</h2>
				<div id="steps" style="width: 100%; heigth: 100%"></div>
			</center>
			<script type="text/javascript">
			


			</script>
		</center>
		</main>
	</h:body>


	<footer> <br />
	<div class="container">
		<ul class="socials">
			<li><a href="#" class="fa fa-facebook"></a></li>
			<li><a href="#" class="fa fa-tumblr"></a></li>
			<li><a href="#" class="fa fa-google-plus"></a></li>
		</ul>
		<div class="copyright">
			Â© <span id="copyright-year"></span> <a href="#">Privacy Policy</a>
		</div>
	</div>
	<div class="tm">
		<a href="#"><img src="resources/template/site/images/TM_logo.png"
			alt="" /></a>
	</div>
	</footer>
	<script src="resources/template/site/js/script.js"></script>
</body>
</html>






